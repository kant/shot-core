<%- include('header') %>

<style>
html, body {
  background-color: black;
}
.aspect-ratio--board {
  padding-bottom: <%= `${ 1 / aspectRatio * 100 }%` %>;
}
.aspect-ratio--w {
  width: <%= `${ (1 / aspectRatio * 100) }%` %>;
}
.dark-gray {
  color: #393939;
}
.bg-dark-gray {
  background-color: #393939;
}
</style>

<!-- monitor: schedule -->
<div class="helvetica pa0 ma0 bg-black white h-100 lh-solid flex w-100 f5 ph4 pb4" style="max-width:1428px; margin: 0 auto;">
  <div class="flex flex-column w-50 h-100 pr2 pt4">

    <div class="flex justify-around items-center h4 mb4">
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7">Scene</div>
        <div class="f-headline ma0"><b><%= scene.scene_number %></b></div>
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7">Shot</div>
        <div class="f-headline ma0"><b><%= shot.shot_number %></b></div>
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7">Take</div>
        <div class="f-headline ma0"><b><%= takeNumber %></b></div>
      </div>
    </div>

    <div class="flex mb3">
      <div class="flex flex-column w-70 pr3">
        <div class="ttu tracked f7 dark-gray mb1">Storyboard</div>
        <img src="<%= scene.imagesPath %>/<%= shot.posterframe %>" />
      </div>
      <div class="flex flex-column <%= nextShot && prevShot ? 'justify-between' : '' %> flex-grow-1">
        <div>
          <% if (prevShot) { %>
            <div class="ttu tracked f7 dark-gray mb1">Previous Shot</div>
            <div class="aspect-ratio aspect-ratio--board">
              <div
                class="aspect-ratio--object cover"
                style="background:url(<%= prevScene.imagesPath %>/<%= prevShot.posterframe %>) center;"
              >
            </div>
            </div>
          <% } %>
        </div>
        <div>
          <% if (nextShot) { %>
            <div class="ttu tracked f7 dark-gray pv1">Next Shot</div>
            <div class="aspect-ratio aspect-ratio--board">
              <div
                class="aspect-ratio--object cover"
                style="background:url(<%= nextScene.imagesPath %>/<%= nextShot.posterframe %>) center;"
                >
              </div>
            </div>
          <% } %>
        </div>
      </div>
    </div>

    <div class="flex justify-between mb3">
      <div class="flex flex-column w-70 pr3">
        <div class="ttu tracked f7 dark-gray mb2">Live Camera</div>
        <img src="<%= scene.imagesPath %>/<%= shot.posterframe %>" />
      </div>
      <div class="flex flex-column w-30">
        <% if (shot.cameraPlot) { %>
          <div class="ttu tracked f7 dark-gray mb2">Shot Diagram</div>
          <img class="db mw-100" src="<%= scene.imagesPath %>/<%= shot.cameraPlot %>" />
        <% } %>
      </div>
    </div>

    <div class="flex justify-between items-center mb3">
      <div class="lh-copy pr4 f6">
        <% for (let board of shot.boards) { %>
          <% if (board.dialogue) { %>
            <span class="ttu">Dialogue:</span> <%= board.dialogue %><br />
          <% } %>
          <% if (board.action) { %>
            <span class="ttu">Action:</span> <%= board.action %><br />
          <% } %>
          <% if (board.notes) { %>
            <span class="ttu">Notes:</span> <%= board.notes %><br />
          <% } %>
        <% } %>
      </div>
      <div class="lh-title pr4">
        <%= shot.shotType %>
      </div>
      <div class="lh-title pr4">
        <%= shot.getCameraFocalLength(scene.metadata.aspectRatio) %><br />
        <%= shot.fStop %>
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7 mb1 dark-gray">Duration</div>
        <div class="f4"><%= friendlyDuration(shot.duration) %></div>
      </div>
    </div>

    <div class="flex justify-between" style="height: 125px">
      <div class="flex flex-column">
        <div class="ttu tracked f7 dark-gray">Audio Status</div>
      </div>
      <div class="flex flex-column">
        <div class="ttu tracked f7 dark-gray">Camera Status</div>
        <div></div>
      </div>
      <div class="flex flex-column">
        <div class="ttu tracked f7 dark-gray">Track Status</div>
        <div></div>
      </div>
    </div>

  </div>

  <div class="flex flex-column w-50 h-100 pl5 pt4 relative">
    <div class="absolute" style="right: 0">
      <div class="ttu tracked f7 dark-gray">
        Shot Core Monitor / Schedule
      </div>
    </div>

    <div class="flex flex-column justify-center h4">
      <div class="w-100">
        <div class="f7 mb1">
          <%= format(day.start_at, 'EEEE, dd MMM yyyy') %>
        </div>
        <div class="flex justify-between">
          <div class="flex items-baseline">
            <div class="f1 fw9 ttu">
              Day 1
            </div>
            <div class="f4 dark-gray ml2">
              / 24
            </div>
          </div>
          <div class="f1 b">
            <span id="clock"></span>
            <script>
              function update () {
                let el = document.getElementById('clock')
                el.innerHTML = new Intl.DateTimeFormat('en-US', {
                  hour: 'numeric',
                  minute: 'numeric',
                  hour12: false
                }).format(new Date())
              }
              setInterval(update, Math.floor(1000 / 3))
              update()
            </script>
          </div>
        </div>
      </div>
    </div>

    <div class="w-100 pb4">
      <div class="ttu b tc mb2">
        Time
      </div>
      <div class="bg-dark-gray w-100 overflow-hidden h2 br4 mb2">
        <div class="inner h2 bg-blue" style="width:50%"></div>
      </div>
      <div class="flex justify-end items-center relative ph1">
        <div class="absolute" style="left: 50%; top: 50%; transform: translate(-50%,-50%)">
          +15m ahead of schedule
        </div>
        <span class="f4">-4h25m</span>
      </div>
    </div>

    <div class="w-100 pb4">
      <div class="ttu b tc mb2">
        Shots
      </div>
      <div class="bg-dark-gray w-100 overflow-hidden h2 br4 mb2">
        <div class="inner h2 bg-blue" style="width:50%"></div>
      </div>
      <div class="flex justify-between ph1">
        <div class="flex">
          6 shots complete
        </div>
        <div class="flex flex-row f4">
          <div class="mr2">
            <b>23 shots left</b>
          </div>
          <div class="dark-gray">
            est. 4h10m
          </div>
        </div>
      </div>
    </div>

    <div class="flex justify-around pb4">
      <div class="flex flex-column items-center">
        <div class="tc ttu mb2 f6">Average Take Setup</div>
        <div class="relative">
          <b class="f4">2m03s</b>
          <div class="absolute dark-gray" style="top: 0; left: 100%">-23s</div>
        </div>
      </div>
      <div class="flex flex-column items-center">
        <div class="tc ttu mb2 f6">Average Shot Setup</div>
        <div class="relative">
          <b class="f4">5m12s</b>
          <div class="absolute dark-gray" style="top: 0; left: 100%">-33s</div>
        </div>
      </div>
      <div class="flex flex-column items-center">
        <div class="tc ttu mb2 f6">Average Take Count</div>
        <div class="relative">
          <b class="f4">5</b>
          <div class="absolute dark-gray" style="top: 0; left: 100%">-2</div>
        </div>
      </div>
    </div>

    <div class="flex justify-between items-center relative">
      <div class="absolute w2 tr" style="left: -3rem;">
        <div class="ttu tracked f7 dark-gray"><b>+1</b></div>
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7 mb2">Scene</div>
        <div class="f4"><b>1</b></div>
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7 mb2">Shot</div>
        <div class="f4"><b>2</b></div>
      </div>
      <div class="self-start">
        Thumbnail
      </div>
      <div class="f6 lh-copy">
        <span class="ttu">Action:</span><br/>
        <span class="ttu">Dialogue:</span><br/>
      </div>
      <div class="f6 lh-copy">
        Medium, Low Angle
      </div>
      <div class="lh-copy">
        50mm<br />
        f/5.6
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7 mb1">Duration</div>
        <div class="f4"><b>1m30s</b></div>
      </div>
      <div class="flex flex-column items-center">
        <div class="ttu tracked f7 dark-gray">1:50 +9m</div>
      </div>
    </div>
  </div>
</div>

<script src="/js/stimulus.umd.js"></script>
<script src="/js/index.js"></script>
</body>
</html>
